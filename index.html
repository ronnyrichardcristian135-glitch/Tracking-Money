<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tracking Money — Cristian & Maharani</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0f172a;
      --card: #1e293b;
      --text: #f1f5f9;
      --primary: #3b82f6;
      --success: #10b981;
      --danger: #ef4444;
      --radius: 16px;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
    }

    header {
      background: var(--primary);
      color: white;
      text-align: center;
      padding: 1rem;
      font-size: 1.3rem;
      font-weight: 600;
    }

    main {
      padding: 1rem;
      display: grid;
      gap: 1rem;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
    }

    input, select, button {
      font-family: inherit;
      font-size: 1rem;
      padding: 0.5rem;
      border-radius: var(--radius);
      border: 1px solid #334155;
      background: #0f172a;
      color: var(--text);
    }

    button {
      background: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover { opacity: 0.9; }

    .flex { display: flex; gap: 0.5rem; flex-wrap: wrap; }

    .green { color: var(--success); }
    .red { color: var(--danger); }
  </style>
</head>

<body>
  <header>Tracking Money — Cristian & Maharani</header>

  <main>
    <div class="card">
      <h3>Input Transaksi</h3>
      <div class="flex">
        <select id="nama">
          <option value="Cristian">Cristian</option>
          <option value="Maharani">Maharani</option>
        </select>
        <select id="jenis">
          <option value="pemasukan">Pemasukan</option>
          <option value="pengeluaran">Pengeluaran</option>
          <option value="tabungan">Tabungan</option>
        </select>
        <input type="number" id="jumlah" placeholder="Jumlah (Rp)" />
        <button id="btnTambah">Tambah</button>
      </div>
    </div>

    <div class="card">
      <h3>Ringkasan</h3>
      <p>Cristian — Pemasukan: <span id="pemasukanCristian">0</span> | Tabungan: <span id="tabunganCristian">0</span> | Sisa: <span id="sisaCristian">0</span></p>
      <p>Maharani — Pemasukan: <span id="pemasukanMaharani">0</span> | Tabungan: <span id="tabunganMaharani">0</span> | Sisa: <span id="sisaMaharani">0</span></p>
    </div>

    <div class="card">
      <h3>Riwayat</h3>
      <ul id="riwayat"></ul>
    </div>
  </main>

  <script>
    // Pastikan tidak ada deklarasi ganda
    if (!window.dataKeuangan) {
      window.dataKeuangan = {
        data: JSON.parse(localStorage.getItem("data")) || [],
        tabungan: JSON.parse(localStorage.getItem("tabungan")) || { Cristian: 0, Maharani: 0 }
      };
    }

    const { data, tabungan } = window.dataKeuangan;

    document.getElementById("btnTambah").addEventListener("click", () => {
      const nama = document.getElementById("nama").value;
      const jenis = document.getElementById("jenis").value;
      const jumlah = parseInt(document.getElementById("jumlah").value || 0);

      if (!jumlah || jumlah <= 0) {
        alert("Masukkan jumlah yang valid");
        return;
      }

      data.push({ nama, jenis, jumlah, waktu: new Date().toLocaleString() });
      localStorage.setItem("data", JSON.stringify(data));

      if (jenis === "tabungan") {
        tabungan[nama] += jumlah;
        localStorage.setItem("tabungan", JSON.stringify(tabungan));
      }

      document.getElementById("jumlah").value = "";
      updateUI();
    });

    function updateUI() {
      let pemasukan = { Cristian: 0, Maharani: 0 };
      let pengeluaran = { Cristian: 0, Maharani: 0 };

      data.forEach(i => {
        if (i.jenis === "pemasukan") pemasukan[i.nama] += i.jumlah;
        else if (i.jenis === "pengeluaran") pengeluaran[i.nama] += i.jumlah;
      });

      const sisaC = pemasukan.Cristian - pengeluaran.Cristian - tabungan.Cristian;
      const sisaM = pemasukan.Maharani - pengeluaran.Maharani - tabungan.Maharani;

      document.getElementById("pemasukanCristian").textContent = pemasukan.Cristian.toLocaleString();
      document.getElementById("pemasukanMaharani").textContent = pemasukan.Maharani.toLocaleString();
      document.getElementById("tabunganCristian").textContent = tabungan.Cristian.toLocaleString();
      document.getElementById("tabunganMaharani").textContent = tabungan.Maharani.toLocaleString();
      document.getElementById("sisaCristian").textContent = sisaC.toLocaleString();
      document.getElementById("sisaMaharani").textContent = sisaM.toLocaleString();

      const riwayat = document.getElementById("riwayat");
      riwayat.innerHTML = "";
      data.slice().reverse().forEach(item => {
        const li = document.createElement("li");
        li.textContent = `${item.waktu} — ${item.nama} ${item.jenis} Rp${item.jumlah.toLocaleString()}`;
        li.className = item.jenis === "pemasukan" ? "green" :
                       item.jenis === "pengeluaran" ? "red" : "";
        riwayat.appendChild(li);
      });
    }

    updateUI();
  </script>
</body>
</html>
