<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tracking Money — Cristian & Maharani</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    * {box-sizing:border-box;font-family:'Poppins',sans-serif;margin:0;padding:0;}
    body{background:#121212;color:#e0e0e0;min-height:100vh;display:flex;flex-direction:column;}
    header{background:#1e1e1e;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #333;}
    header h1{font-size:1.2rem;font-weight:600;color:#00bfa6;}
    header button{background:none;border:none;color:#00bfa6;font-size:1.3rem;cursor:pointer;}
    nav{display:flex;justify-content:space-around;background:#1e1e1e;border-bottom:1px solid #333;}
    nav button{flex:1;background:none;color:#e0e0e0;border:none;padding:0.8rem;cursor:pointer;transition:.2s;}
    nav button.active{border-bottom:3px solid #00bfa6;color:#00bfa6;}
    main{flex:1;overflow-y:auto;padding:1rem;}
    .section{display:none;animation:fadeIn .3s ease;}
    .section.active{display:block;}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .summary{background:#1e1e1e;padding:1rem;border-radius:10px;margin-bottom:1rem;display:grid;gap:.5rem;}
    .summary div{display:flex;justify-content:space-between;font-size:.9rem;border-bottom:1px solid #333;padding-bottom:4px;}
    form{background:#1e1e1e;padding:1rem;border-radius:10px;margin-bottom:1rem;display:flex;flex-direction:column;gap:.5rem;}
    input,select{padding:.6rem;border-radius:8px;border:none;background:#2a2a2a;color:#fff;}
    input::placeholder{color:#aaa;}
    button.submit{background:#00bfa6;border:none;color:#fff;padding:.6rem;border-radius:8px;cursor:pointer;font-weight:600;transition:.2s;}
    button.submit:hover{background:#00d4bb;}
    .history{background:#1e1e1e;padding:1rem;border-radius:10px;}
    .history-item{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #333;padding:6px 0;font-size:.9rem;}
    .history-item button{background:none;border:none;color:#ff5252;font-size:1rem;cursor:pointer;}
    .pay-btn{color:#00bfa6;font-size:.9rem;margin-left:10px;cursor:pointer;}
    @media(max-width:768px){header h1{font-size:1rem;}nav button{font-size:.8rem;}}
  </style>
</head>
<body>

  <header>
    <h1>Tracking Money</h1>
    <button id="resetBtn" title="Reset Semua Data">⚙️</button>
  </header>

  <nav>
    <button class="active" data-target="income">Penghasilan</button>
    <button data-target="saving">Tabungan</button>
    <button data-target="expense">Pengeluaran</button>
    <button data-target="debt">Hutang Aktif</button>
  </nav>

  <main>
    <div class="summary">
      <div><span>Pemasukan Cristian</span><span id="sumCristian">Rp 0</span></div>
      <div><span>Pemasukan Maharani</span><span id="sumMaharani">Rp 0</span></div>
      <div><span>Tabungan Tetap</span><span id="sumTetap">Rp 0</span></div>
      <div><span>Tabungan Bersama</span><span id="sumBersama">Rp 0</span></div>
      <div><span>Pengeluaran Bersama</span><span id="sumPengeluaran">Rp 0</span></div>
    </div>

    <!-- Penghasilan -->
    <section class="section active" id="income">
      <form id="formIncome">
        <select id="incomeName">
          <option value="Cristian">Cristian</option>
          <option value="Maharani">Maharani</option>
        </select>
        <input type="text" id="incomeAmount" placeholder="Nominal (Rp)" />
        <input type="text" id="incomeNote" placeholder="Keterangan" />
        <button type="submit" class="submit">Simpan</button>
      </form>
      <div class="history" id="incomeHistory"></div>
    </section>

    <!-- Tabungan -->
    <section class="section" id="saving">
      <form id="formSaving">
        <select id="savingType">
          <option value="Tetap">Tetap</option>
          <option value="Bersama">Bersama</option>
        </select>
        <select id="savingName">
          <option value="Cristian">Cristian</option>
          <option value="Maharani">Maharani</option>
        </select>
        <input type="text" id="savingAmount" placeholder="Nominal (Rp)" />
        <button type="submit" class="submit">Simpan</button>
      </form>
      <div class="history" id="savingHistory"></div>
    </section>

    <!-- Pengeluaran -->
    <section class="section" id="expense">
      <form id="formExpense">
        <select id="expenseSource">
          <option value="Cristian">Pemasukan Cristian</option>
          <option value="Maharani">Pemasukan Maharani</option>
          <option value="Bersama">Tabungan Bersama</option>
        </select>
        <input type="text" id="expenseAmount" placeholder="Nominal (Rp)" />
        <button type="submit" class="submit">Simpan</button>
      </form>
      <div class="history" id="expenseHistory"></div>
    </section>

    <!-- Hutang Aktif -->
    <section class="section" id="debt">
      <form id="formDebt">
        <select id="debtName">
          <option value="Cristian">Cristian</option>
          <option value="Maharani">Maharani</option>
          <option value="Bersama">Bersama</option>
        </select>
        <input type="text" id="debtAmount" placeholder="Nominal (Rp)" />
        <input type="date" id="debtDate" />
        <button type="submit" class="submit">Simpan</button>
      </form>
      <div class="history" id="debtHistory"></div>
    </section>
  </main>

  <script>
    const summary = JSON.parse(localStorage.getItem('summary')) || {
      Cristian: 0, Maharani: 0, Tetap: 0, Bersama: 0, Pengeluaran: 0
    };

    const histories = JSON.parse(localStorage.getItem('histories')) || {
      income: [], saving: [], expense: [], debt: []
    };

    const els = {
      sumCristian: document.getElementById('sumCristian'),
      sumMaharani: document.getElementById('sumMaharani'),
      sumTetap: document.getElementById('sumTetap'),
      sumBersama: document.getElementById('sumBersama'),
      sumPengeluaran: document.getElementById('sumPengeluaran')
    };

    function formatRupiah(num){return 'Rp ' + Number(num||0).toLocaleString('id-ID');}
    function updateSummary(){
      els.sumCristian.textContent = formatRupiah(summary.Cristian);
      els.sumMaharani.textContent = formatRupiah(summary.Maharani);
      els.sumTetap.textContent = formatRupiah(summary.Tetap);
      els.sumBersama.textContent = formatRupiah(summary.Bersama);
      els.sumPengeluaran.textContent = formatRupiah(summary.Pengeluaran);
      localStorage.setItem('summary', JSON.stringify(summary));
    }

    function renderHistory(){
      ['income','saving','expense','debt'].forEach(type=>{
        const container=document.getElementById(type+'History');
        container.innerHTML='';
        histories[type].forEach((item,i)=>{
          const div=document.createElement('div');
          div.className='history-item';
          div.innerHTML=`<span>${item.text}</span>
            <span>
              ${item.type==='debt' ? `<span class="pay-btn" onclick="payDebt(${i})">Bayar</span>` : ''}
              <button onclick="deleteItem('${type}',${i})">✖</button>
            </span>`;
          container.appendChild(div);
        });
      });
      localStorage.setItem('histories', JSON.stringify(histories));
    }

    function deleteItem(type,i){
      histories[type].splice(i,1);
      renderHistory();
    }

    function cleanNumber(v){return Number((v||'0').toString().replace(/[^\d]/g,''));}

    // Forms
    document.getElementById('formIncome').onsubmit=e=>{
      e.preventDefault();
      const nama=document.getElementById('incomeName').value;
      const nominal=cleanNumber(document.getElementById('incomeAmount').value);
      const note=document.getElementById('incomeNote').value||'';
      summary[nama]+=nominal;
      histories.income.push({text:`${nama} +${formatRupiah(nominal)} ${note}`});
      updateSummary(); renderHistory(); e.target.reset();
    };

    document.getElementById('formSaving').onsubmit=e=>{
      e.preventDefault();
      const jenis=document.getElementById('savingType').value;
      const nama=document.getElementById('savingName').value;
      const nominal=cleanNumber(document.getElementById('savingAmount').value);
      if(jenis==='Tetap'){
        summary[nama]-=nominal;
        summary.Tetap+=nominal;
      }else{
        summary.Cristian-=nominal/2;
        summary.Maharani-=nominal/2;
        summary.Bersama+=nominal;
      }
      histories.saving.push({text:`${jenis} ${nama} ${formatRupiah(nominal)}`});
      updateSummary(); renderHistory(); e.target.reset();
    };

    document.getElementById('formExpense').onsubmit=e=>{
      e.preventDefault();
      const sumber=document.getElementById('expenseSource').value;
      const nominal=cleanNumber(document.getElementById('expenseAmount').value);
      if(sumber==='Cristian') summary.Cristian-=nominal;
      else if(sumber==='Maharani') summary.Maharani-=nominal;
      else summary.Bersama-=nominal;
      summary.Pengeluaran+=nominal;
      histories.expense.push({text:`${sumber} -${formatRupiah(nominal)}`});
      updateSummary(); renderHistory(); e.target.reset();
    };

    document.getElementById('formDebt').onsubmit=e=>{
      e.preventDefault();
      const nama=document.getElementById('debtName').value;
      const nominal=cleanNumber(document.getElementById('debtAmount').value);
      const tanggal=document.getElementById('debtDate').value;
      histories.debt.push({text:`${nama} Hutang ${formatRupiah(nominal)} (JtTempo ${tanggal})`, type:'debt', nama, nominal});
      renderHistory(); e.target.reset();
    };

    window.payDebt=function(i){
      const item=histories.debt[i];
      const sumber=prompt("Bayar dari: Cristian / Maharani / Bersama ?","Bersama");
      if(!sumber)return;
      if(sumber.toLowerCase()==='cristian') summary.Cristian-=item.nominal;
      else if(sumber.toLowerCase()==='maharani') summary.Maharani-=item.nominal;
      else{
        summary.Cristian-=item.nominal/2;
        summary.Maharani-=item.nominal/2;
      }
      histories.debt.splice(i,1);
      updateSummary(); renderHistory();
    }

    document.getElementById('resetBtn').onclick=()=>{
      if(confirm("Yakin reset semua data?")){localStorage.clear();location.reload();}
    };

    document.querySelectorAll('input[type="text"]').forEach(inp=>{
      inp.addEventListener("input",()=>{
        const clean=inp.value.replace(/[^\d]/g,'');
        inp.value=clean?'Rp '+Number(clean).toLocaleString('id-ID'):'';
      });
    });

    document.querySelectorAll("nav button").forEach(btn=>{
      btn.addEventListener("click",()=>{
        document.querySelector("nav button.active").classList.remove("active");
        btn.classList.add("active");
        document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
        document.getElementById(btn.dataset.target).classList.add("active");
      });
    });

    updateSummary(); renderHistory();
  </script>
</body>
</html>
