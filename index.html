<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Web Finansial â€” Cristian & Maharani</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#1e1e2f; --card-bg:#2a2a3d; --text:#e0e0e0; --accent:#4cafef; --danger:#ff4c4c; --success:#4caf50; --input-bg:#3a3a4f; --input-border:#555;
}
*{box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{margin:0;background:var(--bg);color:var(--text);}
header{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--card-bg);}
header h1{margin:0;font-size:1.5rem;}
header .icon{cursor:pointer;font-size:1.2rem;}
nav{display:flex;flex-wrap:wrap;background:var(--card-bg);border-bottom:1px solid #444;}
nav button{flex:1;padding:1rem;background:none;border:none;color:var(--text);cursor:pointer;font-weight:600;}
nav button.active{background:var(--accent);color:#fff;}
.container{padding:1rem;}
.summary{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem;}
.card{flex:1 1 150px;background:var(--card-bg);padding:1rem;border-radius:8px;text-align:center;}
.card h3{margin:0.5rem 0 0.2rem 0;font-size:1rem;}
.card p{margin:0;font-size:1.2rem;font-weight:600;}
.form-section{background:var(--card-bg);padding:1rem;border-radius:8px;margin-bottom:1rem;}
.form-section label{display:block;margin-top:0.5rem;}
.form-section input,.form-section select,.form-section textarea{width:100%;padding:0.5rem;margin-top:0.2rem;border-radius:5px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--text);}
.form-section button{margin-top:0.5rem;padding:0.5rem 1rem;background:var(--accent);border:none;color:#fff;border-radius:5px;cursor:pointer;}
.history{background:var(--card-bg);padding:1rem;border-radius:8px;max-height:300px;overflow-y:auto;}
.history-item{display:flex;flex-direction:column;justify-content:space-between;padding:0.5rem 0;border-bottom:1px solid #444;}
.history-item-main{display:flex;justify-content:space-between;align-items:center;}
.history-item button{background:var(--danger);border:none;color:#fff;border-radius:3px;padding:0 5px;cursor:pointer;margin-left:5px;}
.payment-item{display:flex;justify-content:space-between;margin-left:10px;margin-top:3px;}
.payment-item button{background:var(--danger);padding:0 5px;font-size:0.9rem;}
.payment-form{display:flex;gap:5px;margin-left:10px;margin-top:5px;}
.payment-form input,.payment-form select{flex:1;padding:0.3rem;font-size:0.9rem;}
.table{width:100%;border-collapse:collapse;margin-top:0.5rem;}
.table th,.table td{border:1px solid #555;padding:5px;text-align:center;}
.table th{background:var(--accent);color:#fff;}
.total-row td{font-weight:600;}
@media(max-width:768px){.summary{flex-direction:column;}}
</style>
</head>
<body>

<header>
<h1>Web Finansial</h1>
<div class="icon" title="Riset Data" onclick="resetData()">&#128269;</div>
</header>

<nav>
<button class="nav-btn active" data-target="penghasilan">Penghasilan</button>
<button class="nav-btn" data-target="tabungan">Tabungan</button>
<button class="nav-btn" data-target="pengeluaran">Pengeluaran</button>
<button class="nav-btn" data-target="hutang">Hutang Aktif</button>
<button class="nav-btn" data-target="history-pemasukan">History Pemasukan</button>
</nav>

<div class="container">

<div class="summary" id="summary">
  <div class="card"><h3>Pemasukan Cristian</h3><p id="sum-cristian">Rp0</p></div>
  <div class="card"><h3>Pemasukan Maharani</h3><p id="sum-maharani">Rp0</p></div>
  <div class="card"><h3>Tabungan Tetap</h3><p id="sum-tabungan-tetap">Rp0</p></div>
  <div class="card"><h3>Tabungan Bersama</h3><p id="sum-tabungan-bersama">Rp0</p></div>
  <div class="card"><h3>Pengeluaran Bersama</h3><p id="sum-pengeluaran-bersama">Rp0</p></div>
</div>

<!-- Sections Penghasilan -->
<div id="penghasilan" class="section">
  <div class="form-section">
    <h3>Input Penghasilan</h3>
    <label>Nama</label>
    <select id="input-penghasilan-nama"><option value="Cristian">Cristian</option><option value="Maharani">Maharani</option></select>
    <label>Nominal</label>
    <input type="text" id="input-penghasilan-nominal" oninput="formatInputRibuan(this)" placeholder="1.000.000">
    <label>Keterangan</label>
    <textarea id="input-penghasilan-ket" rows="2"></textarea>
    <button onclick="addPenghasilan()">Tambah</button>
  </div>
  <div class="history" id="history-penghasilan"></div>
</div>

<!-- Sections Tabungan -->
<div id="tabungan" class="section" style="display:none">
  <div class="form-section">
    <h3>Input Tabungan</h3>
    <label>Jenis Tabungan</label>
    <select id="input-tabungan-jenis" onchange="toggleTabunganNama()">
      <option value="Tetap">Tetap</option>
      <option value="Bersama">Bersama</option>
    </select>
    <div id="tabungan-nama-div">
      <label>Nama (jika Tetap)</label>
      <select id="input-tabungan-nama"><option value="Cristian">Cristian</option><option value="Maharani">Maharani</option></select>
    </div>
    <label>Nominal</label>
    <input type="text" id="input-tabungan-nominal" oninput="formatInputRibuan(this)" placeholder="1.000.000">
    <label>Keterangan</label>
    <textarea id="input-tabungan-ket" rows="2"></textarea>
    <button onclick="addTabungan()">Tambah</button>
  </div>
  <div class="history" id="history-tabungan"></div>
</div>

<!-- Sections Pengeluaran -->
<div id="pengeluaran" class="section" style="display:none">
  <div class="form-section">
    <h3>Input Pengeluaran</h3>
    <label>Sumber Dana</label>
    <select id="input-pengeluaran-sumber"><option value="Cristian">Pemasukan Cristian</option><option value="Maharani">Pemasukan Maharani</option><option value="Bersama">Tabungan Bersama</option></select>
    <label>Nominal</label>
    <input type="text" id="input-pengeluaran-nominal" oninput="formatInputRibuan(this)" placeholder="1.000.000">
    <label>Keterangan</label>
    <textarea id="input-pengeluaran-ket" rows="2"></textarea>
    <button onclick="addPengeluaran()">Tambah</button>
  </div>
  <div class="history" id="history-pengeluaran"></div>
</div>

<!-- Sections Hutang -->
<div id="hutang" class="section" style="display:none">
  <div class="form-section">
    <h3>Input Hutang Aktif</h3>
    <label>Nama</label>
    <select id="input-hutang-nama"><option value="Cristian">Cristian</option><option value="Maharani">Maharani</option><option value="Bersama">Bersama</option></select>
    <label>Nominal</label>
    <input type="text" id="input-hutang-nominal" oninput="formatInputRibuan(this)" placeholder="1.000.000">
    <label>Tanggal Jatuh Tempo</label>
    <input type="date" id="input-hutang-tgl">
    <label>Keterangan</label>
    <textarea id="input-hutang-ket" rows="2"></textarea>
    <button onclick="addHutang()">Tambah</button>
  </div>
  <div class="history" id="history-hutang"></div>
  <div class="history" id="history-pembayaran-hutang" style="margin-top:10px;"></div>
</div>

<!-- History Pemasukan Multi-Bulan -->
<div id="history-pemasukan" class="section" style="display:none">
<div class="form-section">
<h3>History Pemasukan Multi-Bulan</h3>
<label>Pilih Tahun</label>
<select id="filter-year"></select>
<button onclick="renderHistoryPemasukanAll()">Tampilkan Semua Bulan</button>
</div>
<div class="history" id="history-pemasukan-container"></div>
</div>

<script>
// Navigation
const navBtns=document.querySelectorAll('.nav-btn');
navBtns.forEach(btn=>btn.addEventListener('click',()=>{
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(btn.dataset.target).style.display='block';
  navBtns.forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}));

// Toggle Nama Tabungan Tetap
function toggleTabunganNama(){
  const jenis=document.getElementById('input-tabungan-jenis').value;
  const div=document.getElementById('tabungan-nama-div');
  div.style.display=(jenis==='Tetap')?'block':'none';
}
toggleTabunganNama();

// Data
let data={}; // data[year][month] = {penghasilan:[], tabungan:[], pengeluaran:[], hutang:[], pembayaranHutang:[]}
const yearSelect=document.getElementById('filter-year');
for(let y=2025;y<=2030;y++){ const opt=document.createElement('option'); opt.value=y; opt.text=y; yearSelect.appendChild(opt);}
const monthSelect=document.getElementById('month-select');
for(let m=1;m<=12;m++){const opt=document.createElement('option'); opt.value=m; opt.text=m; monthSelect.appendChild(opt);}
let currentYear=new Date().getFullYear(); let currentMonth=new Date().getMonth()+1;
if(!data[currentYear]) data[currentYear]={};
if(!data[currentYear][currentMonth]) data[currentYear][currentMonth]={penghasilan:[],tabungan:[],pengeluaran:[],hutang:[],pembayaranHutang:[]};

// Format Ribuan
function formatRibuan(num){return 'Rp'+Number(num).toLocaleString('id-ID');}
function parseRibuan(str){return Number(str.replace(/\./g,''));}
function formatInputRibuan(input){let val=input.value.replace(/\D/g,''); if(val){input.value=Number(val).toLocaleString('id');} else input.value='';}

// Tambah Data
function addPenghasilan(){
  const nama=document.getElementById('input-penghasilan-nama').value;
  const nominal=parseRibuan(document.getElementById('input-penghasilan-nominal').value);
  const ket=document.getElementById('input-penghasilan-ket').value;
  const id=Date.now();
  if(!data[currentYear]) data[currentYear]={};
  if(!data[currentYear][currentMonth]) data[currentYear][currentMonth]={penghasilan:[],tabungan:[],pengeluaran:[],hutang:[],pembayaranHutang:[]};
  data[currentYear][currentMonth].penghasilan.push({id,nama,nominal,ket});
  renderHistory('penghasilan'); updateSummary();
}

function addTabungan(){
  const jenis=document.getElementById('input-tabungan-jenis').value;
  const nama=(jenis==='Tetap')?document.getElementById('input-tabungan-nama').value:'Bersama';
  const nominal=parseRibuan(document.getElementById('input-tabungan-nominal').value);
  const ket=document.getElementById('input-tabungan-ket').value;
  const id=Date.now();
  data[currentYear][currentMonth].tabungan.push({id,jenis,nama,nominal,ket});
  renderHistory('tabungan'); updateSummary();
}

function addPengeluaran(){
  const sumber=document.getElementById('input-pengeluaran-sumber').value;
  const nominal=parseRibuan(document.getElementById('input-pengeluaran-nominal').value);
  const ket=document.getElementById('input-pengeluaran-ket').value;
  const id=Date.now();
  data[currentYear][currentMonth].pengeluaran.push({id,sumber,nominal,ket});
  renderHistory('pengeluaran'); updateSummary();
}

function addHutang(){
  const nama=document.getElementById('input-hutang-nama').value;
  const nominal=parseRibuan(document.getElementById('input-hutang-nominal').value);
  const tgl=document.getElementById('input-hutang-tgl').value;
  const ket=document.getElementById('input-hutang-ket').value;
  const id=Date.now();
  data[currentYear][currentMonth].hutang.push({id,nama,nominal,tgl,ket,pembayaran:[]});
  renderHistory('hutang'); updateSummary();
}

// Render History
function renderHistory(section){
  const cData=data[currentYear][currentMonth];
  let container;
  if(section==='penghasilan'){ container=document.getElementById('history-penghasilan'); container.innerHTML=''; cData.penghasilan.forEach(d=>{const div=document.createElement('div'); div.className='history-item'; div.innerHTML=`<div class="history-item-main"><span>${d.nama}: ${formatRibuan(d.nominal)} - ${d.ket}</span> <button onclick="deleteItem('penghasilan',${d.id})">Hapus</button></div>`; container.appendChild(div);});}
  else if(section==='tabungan'){ container=document.getElementById('history-tabungan'); container.innerHTML=''; cData.tabungan.forEach(d=>{const div=document.createElement('div'); div.className='history-item'; div.innerHTML=`<div class="history-item-main"><span>${d.jenis} ${d.nama}: ${formatRibuan(d.nominal)} - ${d.ket}</span> <button onclick="deleteItem('tabungan',${d.id})">Hapus</button></div>`; container.appendChild(div);});}
  else if(section==='pengeluaran'){ container=document.getElementById('history-pengeluaran'); container.innerHTML=''; cData.pengeluaran.forEach(d=>{const div=document.createElement('div'); div.className='history-item'; div.innerHTML=`<div class="history-item-main"><span>${d.sumber}: ${formatRibuan(d.nominal)} - ${d.ket}</span> <button onclick="deleteItem('pengeluaran',${d.id})">Hapus</button></div>`; container.appendChild(div);});}
  else if(section==='hutang'){ 
    container=document.getElementById('history-hutang'); container.innerHTML=''; 
    const payContainer=document.getElementById('history-pembayaran-hutang'); payContainer.innerHTML='';
    cData.hutang.forEach(d=>{
      const div=document.createElement('div'); div.className='history-item';
      const mainInfo=document.createElement('div'); mainInfo.className='history-item-main';
      mainInfo.innerHTML=`<span>${d.nama}: ${formatRibuan(d.nominal)} - ${d.tgl} - ${d.ket}</span> <button onclick="deleteItem('hutang',${d.id})">Hapus</button>`;
      div.appendChild(mainInfo);
      // pembayaran hutang
      const formDiv=document.createElement('div'); formDiv.className='payment-form';
      formDiv.innerHTML=`<select id="hutang-sumber-${d.id}"><option value="Cristian">Cristian</option><option value="Maharani">Maharani</option><option value="Bersama">Bersama</option></select><input type="text" id="hutang-nominal-${d.id}" oninput="formatInputRibuan(this)" placeholder="Nominal"><button onclick="addPayment(${d.id})">Tambah Pembayaran</button>`;
      div.appendChild(formDiv);
      payContainer.appendChild(div);
    });
  }
}

// Delete Item
function deleteItem(section,id){
  const cData=data[currentYear][currentMonth];
  if(section==='penghasilan') cData.penghasilan=cData.penghasilan.filter(d=>d.id!==id);
  else if(section==='tabungan') cData.tabungan=cData.tabungan.filter(d=>d.id!==id);
  else if(section==='pengeluaran') cData.pengeluaran=cData.pengeluaran.filter(d=>d.id!==id);
  else if(section==='hutang'){
    const hutang=cData.hutang.find(d=>d.id===id);
    if(hutang){
      if(hutang.pembayaran.length>0){
        // pindahkan ke history pembayaran
        hutang.pembayaran.forEach(p=>{
          cData.pembayaranHutang.push({...p,namaHutang:hutang.nama,tgl:hutang.tgl,ket:hutang.ket});
        });
      }
      cData.hutang=cData.hutang.filter(d=>d.id!==id);
    }
  }
  renderHistory(section); updateSummary();
}

// Payment Hutang
function addPayment(hutangId){
  const cData=data[currentYear][currentMonth];
  const hutang=cData.hutang.find(d=>d.id===hutangId);
  if(!hutang) return;
  const sumber=document.getElementById(`hutang-sumber-${hutangId}`).value;
  const nominal=parseRibuan(document.getElementById(`hutang-nominal-${hutangId}`).value);
  if(!nominal||nominal<=0) return;
  hutang.pembayaran.push({sumber,nominal});
  // pindahkan ke pembayaran history
  cData.pembayaranHutang.push({sumber,nominal,namaHutang:hutang.nama,tgl:hutang.tgl,ket:hutang.ket});
  hutang.nominal-=nominal;
  if(hutang.nominal<=0) cData.hutang=cData.hutang.filter(d=>d.id!==hutangId);
  renderHistory('hutang'); updateSummary();
}

// Update Summary
function updateSummary(){
  const cData=data[currentYear][currentMonth];
  let totalCristian=0,totalMaharani=0;
  let sumTabTetap=0,sumTabBersama=0,sumPengBersama=0;
  cData.penghasilan.forEach(d=>{ if(d.nama==='Cristian') totalCristian+=d.nominal; else totalMaharani+=d.nominal; });
  cData.tabungan.forEach(d=>{ if(d.jenis==='Tetap'){ if(d.nama==='Cristian') totalCristian-=d.nominal; else totalMaharani-=d.nominal; sumTabTetap+=d.nominal;} else{ totalCristian-=d.nominal/2; totalMaharani-=d.nominal/2; sumTabBersama+=d.nominal; } });
  cData.pengeluaran.forEach(d=>{ if(d.sumber==='Cristian') totalCristian-=d.nominal; else if(d.sumber==='Maharani') totalMaharani-=d.nominal; else if(d.sumber==='Bersama'){sumPengBersama+=d.nominal; sumTabBersama-=d.nominal;} });
  cData.hutang.forEach(h=>{ h.pembayaran.forEach(p=>{ if(p.sumber==='Cristian') totalCristian-=p.nominal; else if(p.sumber==='Maharani') totalMaharani-=p.nominal; else if(p.sumber==='Bersama'){ totalCristian-=p.nominal/2; totalMaharani-=p.nominal/2; } })});
  document.getElementById('sum-cristian').innerText=formatRibuan(totalCristian);
  document.getElementById('sum-maharani').innerText=formatRibuan(totalMaharani);
  document.getElementById('sum-tabungan-tetap').innerText=formatRibuan(sumTabTetap);
  document.getElementById('sum-tabungan-bersama').innerText=formatRibuan(sumTabBersama);
  document.getElementById('sum-pengeluaran-bersama').innerText=formatRibuan(sumPengBersama);
}

// Reset Data
function resetData(){
  if(confirm("Yakin reset semua data?")){ data={}; updateSummary(); renderHistory('penghasilan'); renderHistory('tabungan'); renderHistory('pengeluaran'); renderHistory('hutang'); }
}

// Render History Pemasukan All
function renderHistoryPemasukanAll(){
  const container=document.getElementById('history-pemasukan-container'); container.innerHTML='';
  for(const y in data){
    for(const m in data[y]){
      const div=document.createElement('div'); div.className='history-item';
      let totalC=0,totalM=0;
      data[y][m].penghasilan.forEach(d=>{ if(d.nama==='Cristian') totalC+=d.nominal; else totalM+=d.nominal; });
      div.innerHTML=`<div><b>${y}-${m}</b> Cristian: ${formatRibuan(totalC)}, Maharani: ${formatRibuan(totalM)}</div>`;
      container.appendChild(div);
    }
  }
}

</script>
</body>
</html>
