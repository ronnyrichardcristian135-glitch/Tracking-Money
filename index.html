<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tracking Money — Cristian & Maharani</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f14; --card:#0f1620; --muted:#b6c2cf; --accent:#6ee7b7; --danger:#ff6b6b; --glass: rgba(255,255,255,0.04);
  font-family:'Poppins',sans-serif;
}
*{box-sizing:border-box;}
body{margin:0; background:var(--bg); color:#e6eef6; min-height:100vh; display:flex; gap:12px; padding:12px;}
.sidebar{width:240px; background:var(--card); border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:12px;}
.sidebar .brand{font-weight:700; font-size:18px; display:flex; align-items:center; gap:10px;}
.sidebar .brand .logo{width:36px; height:36px; border-radius:8px; background:var(--accent); display:flex; justify-content:center; align-items:center; color:#042;}
.sidebar nav{display:flex; flex-direction:column; gap:8px;}
.nav-item{padding:8px 10px; border-radius:8px; color:var(--muted); cursor:pointer; font-weight:600;}
.nav-item.active{background:var(--glass); color:var(--accent);}
.main{flex:1; display:flex; flex-direction:column; gap:12px; min-width:0;}
.cards{display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:10px;}
.card{background:var(--card); padding:12px; border-radius:10px;}
.card h3{margin:0; font-size:13px; color:var(--muted); font-weight:600;}
.amount{font-size:18px; font-weight:700; margin-top:6px;}
.panel{background:var(--card); padding:12px; border-radius:10px;}
form{display:flex; flex-direction:column; gap:8px;}
input, select{padding:8px; border-radius:6px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:inherit; outline:none;}
button{padding:8px 12px; border-radius:8px; border:0; background:var(--accent); color:#042; cursor:pointer; font-weight:700;}
button.btn-ghost{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted);}
.history-list{max-height:280px; overflow:auto; display:flex; flex-direction:column; gap:6px;}
.hitem{display:flex; justify-content:space-between; align-items:center; padding:6px; border-radius:6px; background:rgba(255,255,255,0.02);}
.muted{color:var(--muted); font-size:12px;}
footer{text-align:center; color:var(--muted); font-size:12px; margin-top:6px;}
@media(max-width:900px){body{flex-direction:column;} .sidebar{width:100%; flex-direction:row; justify-content:space-between; align-items:center;}}
</style>
</head>
<body>
<aside class="sidebar">
  <div>
    <div class="brand"><div class="logo">TM</div> Tracking Money</div>
    <div class="muted" style="font-size:12px;">Cristian & Maharani</div>
  </div>
  <nav>
    <div class="nav-item active" data-view="dashboard">Ringkasan</div>
    <div class="nav-item" data-view="input">Input</div>
    <div class="nav-item" data-view="history">History</div>
  </nav>
  <div style="margin-top:auto;">
    <div class="muted" style="font-size:12px;">Total Saldo</div>
    <div style="font-weight:700;font-size:16px;" id="totalSaldo">Rp 0</div>
    <div style="display:flex; gap:6px; margin-top:6px;">
      <button class="btn-ghost" id="clearAll" style="padding:6px;">Clear All</button>
    </div>
  </div>
</aside>

<main class="main">
  <div class="cards">
    <div class="card"><h3>Pemasukan</h3><div class="amount" id="sumIncome">Rp 0</div></div>
    <div class="card"><h3>Tabungan</h3><div class="amount" id="sumSavings">Rp 0</div></div>
    <div class="card"><h3>Pengeluaran</h3><div class="amount" id="sumExpenses">Rp 0</div></div>
    <div class="card"><h3>Hutang</h3><div class="amount" id="sumDebts">Rp 0</div></div>
  </div>

  <section id="view-dashboard" style="margin-top:12px;">
    <div class="panel"><h3>Saldo Detail</h3>
      <div class="muted" style="margin-top:6px;">Cristian / Maharani / Bersama</div>
      <div style="display:flex; gap:12px; margin-top:6px;">
        <div>C: <span id="incomeCristian">Rp 0</span></div>
        <div>M: <span id="incomeMaharani">Rp 0</span></div>
        <div>B: <span id="incomeBersama">Rp 0</span></div>
      </div>
    </div>
  </section>

  <section id="view-input" style="display:none; margin-top:12px;">
    <div class="panel">
      <h3>Input Transaksi</h3>
      <form id="formInput">
        <label>Jenis</label>
        <select id="type">
          <option value="income">Pemasukan</option>
          <option value="saving">Tabungan</option>
          <option value="expense">Pengeluaran</option>
          <option value="debt">Hutang</option>
          <option value="paydebt">Bayar Hutang</option>
        </select>
        <div id="dynamicFields"></div>
        <button type="submit">Simpan</button>
      </form>
    </div>
  </section>

  <section id="view-history" style="display:none; margin-top:12px;">
    <div class="panel">
      <h3>Riwayat Transaksi</h3>
      <div class="history-list" id="historyAll"></div>
    </div>
  </section>

  <footer>© 2025 Tracking Money</footer>
</main>

<script>
const KEY='trackingMoney_simple';
let data = JSON.parse(localStorage.getItem(KEY)||'{"incomes":[],"savings":[],"expenses":[],"debts":[],"payments":[]}');

function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,8);}
function fmt(n){return 'Rp '+Number(n||0).toLocaleString('id-ID');}
function parseNum(v){return Number(String(v||0).replace(/[^\d\-]/g,''))||0;}

function renderAll(){
  const sumIncome = data.incomes.reduce((s,i)=>s+parseNum(i.amount),0);
  const sumSavings = data.savings.reduce((s,i)=>s+parseNum(i.amount),0);
  const sumExpenses = data.expenses.reduce((s,i)=>s+parseNum(i.amount),0);
  const sumDebts = data.debts.reduce((s,i)=>s+parseNum(i.remaining||i.amount),0);
  document.getElementById('sumIncome').innerText = fmt(sumIncome);
  document.getElementById('sumSavings').innerText = fmt(sumSavings);
  document.getElementById('sumExpenses').innerText = fmt(sumExpenses);
  document.getElementById('sumDebts').innerText = fmt(sumDebts);

  document.getElementById('incomeCristian').innerText = fmt(data.incomes.filter(x=>x.source==='cristian').reduce((s,i)=>s+parseNum(i.amount),0));
  document.getElementById('incomeMaharani').innerText = fmt(data.incomes.filter(x=>x.source==='maharani').reduce((s,i)=>s+parseNum(i.amount),0));
  document.getElementById('incomeBersama').innerText = fmt(data.incomes.filter(x=>x.source==='bersama').reduce((s,i)=>s+parseNum(i.amount),0));

  const totalSaldo = sumIncome - sumSavings - sumExpenses;
  document.getElementById('totalSaldo').innerText = fmt(totalSaldo);

  const historyAll = document.getElementById('historyAll'); if(historyAll) historyAll.innerHTML='';
  ['incomes','savings','expenses','debts','payments'].forEach(cat=>{
    data[cat].forEach(item=>{
      if(!historyAll) return;
      const div=document.createElement('div'); div.className='hitem';
      div.innerHTML=`<div>${cat.toUpperCase()} • ${item.note||''}</div><div>${fmt(item.amount||item.remaining||0)}</div>`;
      historyAll.appendChild(div);
    });
  });
  localStorage.setItem(KEY, JSON.stringify(data));
}

function buildDynamic(){
  const type=document.getElementById('type').value;
  const dyn=document.getElementById('dynamicFields'); dyn.innerHTML='';
  if(type==='income'||type==='saving'||type==='expense'){
    dyn.innerHTML=`
      <label>Jumlah (Rp)</label><input id="q_amount" inputmode="numeric">
      <label>Sumber</label>
      <select id="q_source">
        <option value="cristian">Cristian</option>
        <option value="maharani">Maharani</option>
        <option value="bersama">Bersama</option>
      </select>
      <label>Catatan</label><input id="q_note">
    `;
  } else if(type==='debt'){
    dyn.innerHTML=`<label>Jumlah Hutang (Rp)</label><input id="q_amount" inputmode="numeric"><label>Catatan</label><input id="q_note">`;
  } else if(type==='paydebt'){
    let options='<option value="">--pilih hutang--</option>';
    data.debts.forEach(d=>options+=`<option value="${d.id}">${d.note} - sisa: ${fmt(d.remaining||d.amount)}</option>`);
    dyn.innerHTML=`
      <label>Hutang</label><select id="q_debtId">${options}</select>
      <label>Jumlah Bayar (Rp)</label><input id="q_amount" inputmode="numeric">
      <label>Sumber</label>
      <select id="q_source">
        <option value="cristian">Cristian</option>
        <option value="maharani">Maharani</option>
        <option value="bersama">Bersama</option>
      </select>
      <label>Catatan</label><input id="q_note">
    `;
  }
}
document.getElementById('type').addEventListener('change', buildDynamic);
buildDynamic();

document.getElementById('formInput').addEventListener('submit', e=>{
  e.preventDefault();
  const type=document.getElementById('type').value;
  const amount=parseNum(document.getElementById('q_amount')?.value);
  const source=document.getElementById('q_source')?.value||'bersama';
  const note=document.getElementById('q_note')?.value||'';
  if(type==='income') data.incomes.push({id:uid(), amount, source, note, date:new Date().toISOString()});
  else if(type==='saving') data.savings.push({id:uid(), amount, source, note, date:new Date().toISOString()});
  else if(type==='expense') data.expenses.push({id:uid(), amount, source, note, date:new Date().toISOString()});
  else if(type==='debt') data.debts.push({id:uid(), amount, note, date:new Date().toISOString(), remaining:amount});
  else if(type==='paydebt'){
    const debtId=document.getElementById('q_debtId')?.value;
    const debt=data.debts.find(d=>d.id===debtId);
    if(!debt) return alert('Pilih hutang valid'); 
    const payAmount=Math.min(amount, debt.remaining||debt.amount); 
    debt.remaining=(debt.remaining||debt.amount)-payAmount; 
    data.payments.push({id:uid(), debtId, amount:payAmount, source, note, date:new Date().toISOString()});
  }
  document.getElementById('formInput').reset();
  buildDynamic();
  renderAll();
});

document.getElementById('clearAll').addEventListener('click', ()=>{
  if(confirm('Hapus semua data?')){ data={incomes:[],savings:[],expenses:[],debts:[],payments:[]}; renderAll(); }
});

document.querySelectorAll('.nav-item').forEach(n=>{
  n.addEventListener('click', ()=>{
    document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active'));
    n.classList.add('active');
    const v=n.getAttribute('data-view');
    document.querySelectorAll('section[id^="view-"]').forEach(s=>s.style.display=s.id==='view-'+v?'':'none');
  });
});

renderAll();
</script>
</body>
</html>
